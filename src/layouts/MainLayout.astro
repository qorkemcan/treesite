---
// src/layouts/MainLayout.astro
import { SITE_CONFIG } from "../config.js";

interface Props {
  title: string;
  description: string;
  badgeText?: string;
  ogImage?: string;
}

const {
  title,
  description,
  badgeText = "‚úì 2026 OFFICIAL FLORIDA DIRECTORY ‚Ä¢ LICENSED & INSURED SPECIALISTS",
  ogImage = SITE_CONFIG.defaultOGImage,
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, SITE_CONFIG.siteUrl);
const fullTitle = `${title} | ${SITE_CONFIG.brandName}`;
const GTM_ID = "GTM-PW924QGW";
---

<!doctype html>
<html lang="en">
  <head>
    <!-- Google Tag Manager -->
    <script is:inline define:vars={{ GTM_ID }}>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", GTM_ID);
    </script>

    <!-- Global LocalBusiness Schema -->
    <script type="application/ld+json" is:inline define:vars={{ brandName: SITE_CONFIG.brandName, phone: SITE_CONFIG.phone, siteUrl: SITE_CONFIG.siteUrl }}>
      {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "name": brandName,
        "image": "https://protreetrim.com/og-image.jpg",
        "@id": siteUrl,
        "url": siteUrl,
        "telephone": phone,
        "priceRange": "$$",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Statewide",
          "addressRegion": "FL",
          "addressCountry": "US"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 27.6648,
          "longitude": -81.5158
        }
      }
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>{fullTitle}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalURL} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet" />

    <style is:global>
      :root { --primary: #1b4332; --primary-dark: #081c15; --secondary: #ea580c; --bg-light: #fcfcfc; }
      * { font-family: "Inter", sans-serif !important; box-sizing: border-box; scroll-behavior: smooth; }
      body { margin: 0; background: var(--bg-light); color: #1a1a1a; line-height: 1.5; }
      .container { max-width: 1200px; margin: 0 auto; padding: 0 1.2rem; }
      
      .nav-link { color: #4b5563; text-decoration: none; font-weight: 700; font-size: 0.8rem; text-transform: uppercase; transition: 0.2s; }
      .nav-link:hover { color: var(--secondary); }

      .trust-badge-footer {
        background: rgba(255, 255, 255, 0.05);
        padding: 18px;
        border-radius: 14px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 0.8rem;
        font-weight: 600;
        text-align: left;
        color: white;
      }
      .trust-badge-footer span:first-child { font-size: 1.8rem; }
    </style>
  </head>
  <body>
    <noscript><iframe src={`https://www.googletagmanager.com/ns.html?id=${GTM_ID}`} height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <div style="background: var(--primary-dark); color: #ffb703; padding: 8px; text-align: center; font-size: 0.65rem; font-weight: 900; letter-spacing: 0.5px; text-transform: uppercase;">
      {badgeText}
    </div>

    <!-- Navigation -->
    <nav style="background: rgba(255, 255, 255, 0.98); border-bottom: 1px solid #eee; padding: 0.6rem 0; position: sticky; top: 0; z-index: 10000; backdrop-filter: blur(10px);">
      <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
        <a href="/" style="text-decoration: none; display: flex; align-items: center; gap: 6px;">
          <div style="background: var(--primary); width: 30px; height: 30px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 1rem;">üå≥</div>
          <span style="font-weight: 900; color: var(--primary); font-size: 1.15rem; letter-spacing: -0.5px; text-transform: uppercase;">Pro<span style="color: var(--secondary);">Tree</span>Trim</span>
        </a>
        <div style="display: flex; gap: 15px; align-items: center;" class="desktop-only">
          <a href="/services" class="nav-link">Services</a>
          <a href="/gallery" class="nav-link">Gallery</a>
          <a href="/trust-safety" class="nav-link" style="color: var(--primary); border-bottom: 2px solid #ffb703;">Trust & Safety</a>
          <a href="/about" class="nav-link">About</a>
          <a href="/contact" class="nav-link">Contact</a>
          <a href={SITE_CONFIG.phoneHref} style="background: var(--primary); color: white !important; padding: 10px 16px; border-radius: 8px; text-decoration: none; font-weight: 800; font-size: 0.75rem;">CALL NOW</a>
        </div>
      </div>
    </nav>

    <slot />

    <footer style="background: var(--primary-dark); color: #d1fae5; padding: 5rem 1.5rem 10rem; text-align: center; border-top: 6px solid var(--secondary);">
      <div class="container">
        
        <!-- Trust Badges -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 50px;">
          <div class="trust-badge-footer">
            <span>üõ°Ô∏è</span>
            <span>LICENSED & INSURED<br/><small style="opacity: 0.7; font-weight: 400;">Verified Florida Network</small></span>
          </div>
          <div class="trust-badge-footer">
            <span>‚ö°</span>
            <span>24/7 RESPONSE<br/><small style="opacity: 0.7; font-weight: 400;">Emergency Storm Dispatch</small></span>
          </div>
          <div class="trust-badge-footer">
            <span>üí∞</span>
            <span>FREE ESTIMATES<br/><small style="opacity: 0.7; font-weight: 400;">No-Obligation Quotes</small></span>
          </div>
        </div>

        <p style="font-weight: 900; font-size: 1.4rem; margin-bottom: 25px; color: white; letter-spacing: -0.5px;">ProTreeTrim‚Ñ¢ Florida</p>
        
        <!-- Footer Links -->
        <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; font-weight: 700; font-size: 0.8rem; text-transform: uppercase; margin-bottom: 40px;">
          <a href="/" style="color: white; text-decoration: none;">Directory</a>
          <a href="/services" style="color: white; text-decoration: none;">Services</a>
          <a href="/gallery" style="color: white; text-decoration: none;">Gallery</a>
          <a href="/trust-safety" style="color: #ffb703; text-decoration: none;">Trust & Safety</a>
          <a href="/about" style="color: white; text-decoration: none;">About</a>
          <a href="/privacy" style="color: white; text-decoration: none;">Privacy</a>
          <a href="/contact" style="color: white; text-decoration: none;">Contact</a>
        </div>

        <!-- Copyright & Disclaimer -->
        <div style="max-width: 800px; margin: 0 auto; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 30px;">
          <p style="font-size: 0.75rem; opacity: 0.8; margin-bottom: 15px; font-weight: 600;">
            ¬© {SITE_CONFIG.year} ProTreeTrim‚Ñ¢ Florida. Licensed & Insured Expert Dispatch Network.
          </p>
          <p style="font-size: 0.7rem; opacity: 0.5; line-height: 1.6; text-align: justify;">
            <strong>Disclaimer:</strong> ProTreeTrim‚Ñ¢ is a professional referral and dispatch network. We connect Florida homeowners with independently owned and operated tree service professionals. ProTreeTrim‚Ñ¢ does not directly provide tree removal or arborist services. It is the responsibility of the homeowner to verify that the contractor they are matched with maintains necessary licenses and insurance required by their specific Florida county or municipality.
          </p>
        </div>
      </div>
    </footer>

    <!-- Fixed Mobile Button -->
    <div style="position: fixed; bottom: 0; left: 0; right: 0; background: rgba(255,255,255,0.98); padding: 12px; z-index: 10001; border-top: 1px solid #eee; display: flex; justify-content: center; box-shadow: 0 -5px 15px rgba(0,0,0,0.05);">
      <a href={SITE_CONFIG.phoneHref} style="background: var(--secondary); color: white !important; width: 100%; max-width: 500px; padding: 16px; text-decoration: none; border-radius: 12px; font-weight: 900; text-align: center; font-size: 1.1rem; display: flex; align-items: center; justify-content: center; gap: 10px;">
        üìû CALL FOR FREE ESTIMATE
      </a>
    </div>
  </body>
</html>